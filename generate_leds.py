import pandas as pd
df = pd.read_excel (r'sekwencje.xlsx',usecols=[0,1,2,3,4])

led_types = {
'Q_6_LFI_15s' :	[300,700,300,700,300,700,300,700,300,700,300,700,2000,7000,0,0,0,0,0],
'Q' :	[500,500,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Q_9_16s' :	[300,700,300,700,300,700,300,700,300,700,300,700,300,700,300,700,300,7700,0],
'Q_9_15s' :	[300,700,300,700,300,700,300,700,300,700,300,700,300,700,300,700,300,6700,0],
'Q_3_10s' :	[300,700,300,700,300,7700,0,0,0,0,0,0,0,0,0,0,0,0,0],
'FI_3_9s' :	[300,1000,300,1000,300,6100,0,0,0,0,0,0,0,0,0,0,0,0,0],
'FI_6s' :	[1000,5000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'FI_5s' :	[900,4100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'FI_2,5s' :	[5000,2000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'FI_4s' :	[800,3200,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'FI_3s' :	[1000,2000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'FI_2_5s' :	[400,600,400,3600,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Mo_A_6s' :	[300,600,1000,4100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Mo_A_10s' :[500,500,1500,7500,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'LFI_10s' :	[3000,7000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'LFI_6s' :	[2000,4000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Iso_2s' :	[1000,1000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Iso_5s' :	[2500,2500,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Iso_4s' :	[2000,2000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Iso_10s' :	[5000,5000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Oc_4s' :	[2500,1500,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Oc_5s' :	[3000,2000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Oc_10s' :	[6000,4000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Oc_12s' :	[7000,5000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'F' :	[5000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'DIR' :	[5000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'None' :	[5000,5000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Oc_3_15s' :	[3000,1500,3000,1500,3000,3000,0,0,0,0,0,0,0,0,0,0,0,0,0],
'LFI_5s' :	[1800,3200,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'LFI_2_12s' :	[400,600,400,10600,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'Mo_A_20s' :	[1000,1000,3000,15000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
'FI_3_10s' :	[300,1000,300,1000,300,7100,0,0,0,0,0,0,0,0,0,0,0,0,0]





}
colors = {
	'R' : [255,0,0],
	'G' : [0,255,0],
	'Y' : [255,150,0],
	'W' : [255,255,150]
}
num_of_leds = 132;
f = open("led_list.txt", 'w')

latarns = {
'#Jastarnia' : [],
'#Kaszyca' : [],
'#Hel' : [],
'#Gdansk' : [],
'#Sopot' : [],
'#Krynica' : [],
'#Shchukinskiy' : [],
'#Obzornyy' : [],
'#Taran' : [],
'#Rozewie' : []
}

# f.write("Now the file has more content!")

def generate_bouys():
	f.write('buoy buoyList[BUOYS] = {')
	for row in df.values:
		if(row[4] == 'None'):
			f.write('{'+str(row[0])+','+str(row[1])+','+str(row[2])+',{0,0,0},'+str(sum(map(lambda x : x!= 0, led_types[row[4]]))-1)+',0,'+str(led_types[row[4]]).replace('[','{').replace(']','}')+',0},'+'\n')
		elif(row[4][0] == '#'):
			latarns[row[4]].append(row)
		else:
			f.write('{'+str(row[0])+','+str(row[1])+','+str(row[2])+','+str(colors[row[3]]).replace('[','{').replace(']','}')+','+str(sum(map(lambda x : x!= 0, led_types[row[4]]))-1)+',0,'+str(led_types[row[4]]).replace('[','{').replace(']','}')+',0},'+'\n')
	f.write('};')
def generate_latarns():
	first  = True
	for key,value in latarns.items():
		f.write('\n\nlighthouse '+ key[1:]+'['+str(len(value))+'] = {\n')
		for row in value:
			if(first):
				f.write('{'+str(row[0])+','+str(row[1])+','+str(row[2])+','+str(colors[row[3]]).replace('[','{').replace(']','}')+',0,1},\n')
				first = False
			else:
				f.write('{'+str(row[0])+','+str(row[1])+','+str(row[2])+','+str(colors[row[3]]).replace('[','{').replace(']','}')+',0,0},\n')
		first = True
		f.write('};')
generate_bouys()
generate_latarns()

for key,value in latarns.items():
	f.write('\nint '+key[1:]+"_n_leds = "+str(len(value))+';')

f.close()